<table>
  <tr class="first_row">
    <th colspan="3" class="border border-dark"></th>
    <th colspan="4" class="border border-dark">現場①</th>
    <th colspan="4" class="border border-dark">現場②</th>
    <th colspan="4" class="border border-dark">現場③</th>
    <th class="border border-dark">修理中</th>
  </tr>
  <tr class="second_row">
    <th class="border border-dark  mat">資産名</th>
    <th class="border border-dark">メーカー</th>
    <th class="border border-dark">会社数量</th>
    <%# 現場① %>
    <th class="border border-dark">現場名</th>
    <th class="border border-dark">使用数</th>
    <th class="border border-dark">使用者</th>
    <th class="border border-dark">使用期間</th>
    <%# 現場② %>
    <th class="border border-dark">現場名</th>
    <th class="border border-dark">使用数</th>
    <th class="border border-dark">使用者</th>
    <th class="border border-dark">使用期間</th>
    <%# 現場③ %>
    <th class="border border-dark">現場名</th>
    <th class="border border-dark">使用数</th>
    <th class="border border-dark">使用者</th>
    <th class="border border-dark">使用期間</th>
    <%# 修理中 %>
    <th class="border border-dark">数量</th>
  </tr>
  <% @materials.each do |material| %>
    <tr class="border border-dark record" onclick= window.location="<%= "/materials/" + material.id.to_s + "/edit" %>"  role="link">
      <td class="border border-dark">
        <%= material.material_name %>  <%# 資産名 %>
      </td>
      <td class="border border-dark">
        <%= material.maker %>  <%# メーカー %>
      </td>

      <td class="border border-dark">
        <%= material.company_count %>  <%# 会社 %>
      </td>

      <% locations = material.locations.first(3) %>
      <% 3.times do |i| %>
        <% location = locations[i] %>
        <td class="border border-dark">
          <%= location&.place %>  <%# 現場名 %>
        </td>
        <td class="border border-dark">
          <%= location&.use_count %>  <%# 使用数 %>
        </td>
        <td class="border border-dark">
          <% if location&.user == "その他" && location&.other_users != nil %>
            <%= location&.other_users %>  <%# その他使用者 %>
          <% else %>
            <%= location&.user %>  <%# 使用者 %>
          <% end %>
        </td>
        <td class="period">
          <%= location&.period_start %><br>
          ~<br>
          <%= location&.period_end %>  <%# 使用期間 %>
        </td>
      <% end %>

    <%# 修理中 %>
      <td class="border border-dark">
        <%= material.repair.repair_count %> <%# 修理数 %>
      </td>
    </tr>
  <% end %>
</table>
